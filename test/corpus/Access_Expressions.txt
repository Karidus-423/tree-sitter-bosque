=======================================
Access Field Simple 1
=======================================

entity Foo {
	field f: Int;
}

function main(x: Foo): Int {
	return x.f;
}

---

(source_file
  (entity
    (identifier)
    (field
      (variable_expression
        (identifier)
        (primitive_type))))
  (function_definition
    (function_modifier)
    (function_signature
      (identifier)
      (function_parameters
        (variable_expression
          (identifier)
          (identifier)))
      (function_return_parameters
        (primitive_type))
      (function_body
        (return_statement
          (access_expression
            (identifier)
            (identifier)))))))

=======================================
Access Field Simple 2
=======================================

entity Foo {
	field f: Int;
}

function foo(): Foo {
	return Foo{1i};
}

function main(): Int {
	return foo().f;
}

---

(source_file
  (entity
    (identifier)
    (field
      (variable_expression
        (identifier)
        (primitive_type))))
  (function_definition
    (function_modifier)
    (function_signature
      (identifier)
      (function_parameters)
      (function_return_parameters
        (identifier))
      (function_body
        (return_statement
          (type_definition
            (identifier)
            (num_whole))))))
  (function_definition
    (function_modifier)
    (function_signature
      (identifier)
      (function_parameters)
      (function_return_parameters
        (primitive_type))
      (function_body
        (return_statement
          (access_expression
            (function_call
              (identifier))
            (identifier)))))))

=======================================
Simple Field Updates 1
=======================================

entity Foo {
	field x: Int;
}

function main(): Int {
	var v = Foo{1i};
	return v[x = 2i].x;
}

---

(source_file
  (entity
    (identifier)
    (field
      (identifier)
      (primitive_type)))
  (function_definition
    (function_modifier)
    (function_signature
      (identifier)
      (function_parameters)
      (function_return_parameters
        (primitive_type))
      (function_body
        (variable_statement
          (variable_expression
            (variable_definition
              (identifier))
            (type_definition
              (identifier)
              (num_whole))))
        (return_statement
          (access_expression
            (entity_update
              (identifier)
              (variable_redefinition
                (variable_definition
                  (identifier)))
              (num_whole))
            (identifier)))))))

=======================================
Simple Field Updates 2
=======================================

entity Foo {
	field x: Int;
}

function main(): Int {
	var v = Foo{1i};
	return v[x = $x + 1i].x;
}

---

(source_file
  (entity
    (identifier)
    (field
      (identifier)
      (primitive_type)))
  (function_definition
    (function_modifier)
    (function_signature
      (identifier)
      (function_parameters)
      (function_return_parameters
        (primitive_type))
      (function_body
        (variable_statement
          (variable_expression
            (variable_definition
              (identifier))
            (type_definition
              (identifier)
              (num_whole))))
        (return_statement
          (access_expression
            (entity_update
              (identifier)
              (variable_redefinition
                (variable_definition
                  (identifier)))
              (binary_expression
                (identifier
                  (modifier))
                (num_whole)))
            (identifier)))))))

=======================================
Postfix Field Updates 1
=======================================

entity Foo {
	field x: Int;
	field y: Int;
}

entity Bar {
	field f: Foo;
}

function main(): Int {
	let a = Bar{Foo{1i, 0i}};
	let b = a.f[x = 3i];
	return b.x;
}

---

(source_file
  (entity
    (identifier)
    (field
      (identifier)
      (primitive_type))
    (field
      (identifier)
      (primitive_type)))
  (entity
    (identifier)
    (field
      (identifier)
      (identifier)))
  (function_definition
    (function_modifier)
    (function_signature
      (identifier)
      (function_parameters)
      (function_return_parameters
        (primitive_type))
      (function_body
        (variable_statement
          (variable_expression
            (variable_definition
              (identifier))
            (type_definition
              (identifier)
              (type_definition
                (identifier)
                (num_whole)
                (num_whole)))))
        (variable_statement
          (variable_expression
            (variable_definition
              (identifier))
            (access_expression
              (identifier)
              (entity_update
                (identifier)
                (variable_redefinition
                  (variable_definition
                    (identifier)))
                (num_whole)))))
        (return_statement
          (access_expression
            (identifier)
            (identifier)))))))
