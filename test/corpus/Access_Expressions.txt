=======================================
Access Field Simple 1
=======================================

entity Foo {
	field f: Int;
}

function main(x: Foo): Int {
	return x.f;
}

---

(source_file
  (entity_declaration
    (custom_type)
    (object_body
      (field_statement
        (variable_expression
          (variable_signature
            (identifier)
            (primitive_type))))))
  (function_definition
    (function_signature
      (custom_type)
      (function_parameters
        (variable_expression
          (variable_signature
            (identifier)
            (custom_type))))
      (function_return_parameters
        (primitive_type))
      (function_usage
        (object_body
          (return_statement
            (access_expression
              (identifier)
              (identifier))))))))

=======================================
Access Field Simple 2
=======================================

entity Foo {
	field f: Int;
}

function foo(): Foo {
	return Foo{1i};
}

function main(): Int {
	return foo().f;
}

---

(source_file
  (entity_declaration
    (custom_type)
    (object_body
      (field_statement
        (variable_expression
          (variable_signature
            (identifier)
            (primitive_type))))))
  (function_definition
    (function_signature
      (custom_type)
      (function_parameters)
      (function_return_parameters
        (custom_type))
      (function_usage
        (object_body
          (return_statement
            (object_creation
              (custom_type)
              (num_whole)))))))
  (function_definition
    (function_signature
      (custom_type)
      (function_parameters)
      (function_return_parameters
        (primitive_type))
      (function_usage
        (object_body
          (return_statement
            (access_expression
              (function_call
                (custom_type)
                (function_call_parameters))
              (identifier))))))))

=======================================
Simple Field Updates 1
=======================================

entity Foo {
	field x: Int;
}

function main(): Int {
	var v = Foo{1i};
	return v[x = 2i].x;
}

---

(source_file
  (entity_declaration
    (custom_type)
    (object_body
      (field_statement
        (variable_expression
          (variable_signature
            (identifier)
            (primitive_type))))))
  (function_definition
    (function_signature
      (custom_type)
      (function_parameters)
      (function_return_parameters
        (primitive_type))
      (function_usage
        (object_body
          (variable_statement
            (variable_expression
              (variable_signature
                (identifier))
              (variable_assignment
                (object_creation
                  (custom_type)
                  (num_whole)))))
          (return_statement
            (access_expression
              (object_update
                (identifier)
                (object_update_block
                  (variable_expression
                    (variable_signature
                      (identifier))
                    (variable_assignment
                      (num_whole)))))
              (identifier))))))))

=======================================
Simple Field Updates 2
=======================================

entity Foo {
	field x: Int;
}

function main(): Int {
	var v = Foo{1i};
	return v[x = $x + 1i].x;
}

---

(source_file
  (entity_declaration
    (custom_type)
    (object_body
      (field_statement
        (variable_expression
          (variable_signature
            (identifier)
            (primitive_type))))))
  (function_definition
    (function_signature
      (custom_type)
      (function_parameters)
      (function_return_parameters
        (primitive_type))
      (function_usage
        (object_body
          (variable_statement
            (variable_expression
              (variable_signature
                (identifier))
              (variable_assignment
                (object_creation
                  (custom_type)
                  (num_whole)))))
          (return_statement
            (access_expression
              (object_update
                (identifier)
                (object_update_block
                  (variable_expression
                    (variable_signature
                      (identifier))
                    (variable_assignment
                      (binary_expression
                        (identifier
                          (modifier))
                        (num_whole))))))
              (identifier))))))))

=======================================
Postfix Field Updates 1
=======================================

entity Foo {
	field x: Int;
	field y: Int;
}

entity Bar {
	field f: Foo;
}

function main(): Int {
	let a = Bar{Foo{1i, 0i}};
	let b = a.f[x = 3i];
	return b.x;
}

---

(source_file
  (entity_declaration
    (custom_type)
    (object_body
      (field_statement
        (variable_expression
          (variable_signature
            (identifier)
            (primitive_type))))
      (field_statement
        (variable_expression
          (variable_signature
            (identifier)
            (primitive_type))))))
  (entity_declaration
    (custom_type)
    (object_body
      (field_statement
        (variable_expression
          (variable_signature
            (identifier)
            (custom_type))))))
  (function_definition
    (function_signature
      (custom_type)
      (function_parameters)
      (function_return_parameters
        (primitive_type))
      (function_usage
        (object_body
          (variable_statement
            (variable_expression
              (variable_signature
                (identifier))
              (variable_assignment
                (object_creation
                  (custom_type)
                  (object_creation
                    (custom_type)
                    (num_whole)
                    (num_whole))))))
          (variable_statement
            (variable_expression
              (variable_signature
                (identifier))
              (variable_assignment
                (access_expression
                  (identifier)
                  (object_update
                    (identifier)
                    (object_update_block
                      (variable_expression
                        (variable_signature
                          (identifier))
                        (variable_assignment
                          (num_whole)))))))))
          (return_statement
            (access_expression
              (identifier)
              (identifier))))))))
